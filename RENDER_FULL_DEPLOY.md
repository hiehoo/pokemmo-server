# 🚀 Deploy Everything on Render (Server + Client)

This guide shows you how to deploy BOTH your PokeMMO server and client on Render using a single configuration.

## ✅ What You'll Get

After deployment, you'll have:
- **Server**: `https://pokemmo-server.onrender.com` - Backend API & WebSocket
- **Client**: `https://pokemmo-client.onrender.com` - Game UI with Solana wallet

Both services on Render's FREE tier!

## 📋 Prerequisites

1. ✅ Code pushed to GitHub (already done!)
2. ✅ Render account (free at render.com)
3. ✅ Phantom wallet (optional, for testing rewards)

## 🎯 Step-by-Step Deployment

### Step 1: Update Client Configuration

First, update the client to point to your Render server URL:

1. Open `client/index.html`
2. Find these lines (around line 334-340):
```javascript
const SERVER_URL = window.location.hostname === 'localhost' 
    ? 'http://localhost:3000' 
    : 'https://pokemmo-server.onrender.com';

const WS_URL = window.location.hostname === 'localhost'
    ? 'ws://localhost:3000'
    : 'wss://pokemmo-server.onrender.com';
```

These are already configured correctly! ✅

### Step 2: Push to GitHub

```bash
# Add all changes
git add .

# Commit
git commit -m "Add Render deployment for both server and client"

# Push to GitHub
git push origin master
```

### Step 3: Deploy on Render

#### Option A: Blueprint Deployment (Recommended - Deploys Everything at Once!)

1. Go to https://dashboard.render.com
2. Click **"New +"** → **"Blueprint"**
3. Connect your GitHub repository: `hiehoo/pokemmo-server`
4. Render will detect the `render.yaml` file
5. You'll see TWO services:
   - `pokemmo-server` (Backend)
   - `pokemmo-client` (Frontend)
6. Click **"Apply"**

#### Option B: Manual Deployment (Deploy Each Service)

**Deploy Server First:**
1. Click **"New +"** → **"Web Service"**
2. Connect repository
3. Configure:
   - Name: `pokemmo-server`
   - Root Directory: `server`
   - Build: `npm install`
   - Start: `node server.js`
4. Add environment variable:
   - `TREASURY_PRIVATE_KEY`: (optional, your Solana wallet key)
5. Click **"Create Web Service"**

**Then Deploy Client:**
1. Click **"New +"** → **"Static Site"**
2. Connect same repository
3. Configure:
   - Name: `pokemmo-client`
   - Root Directory: `client`
   - Build: `npm install && npm run build`
   - Publish: `dist`
4. Click **"Create Static Site"**

### Step 4: Wait for Deployment

Both services will build and deploy. This takes about 5-10 minutes total.

Watch the logs:
- ✅ Server: Should show "Listening on ws://localhost:3000"
- ✅ Client: Should show "Build successful"

### Step 5: Access Your Game!

Once deployed:

1. **Open the game**: https://pokemmo-client.onrender.com
2. **Check server health**: https://pokemmo-server.onrender.com/colyseus
3. **Connect Phantom wallet** and start playing!

## 🎮 URLs After Deployment

| Service | URL | Purpose |
|---------|-----|---------|
| Game UI | https://pokemmo-client.onrender.com | Play the game |
| Server API | https://pokemmo-server.onrender.com | Backend API |
| Colyseus Monitor | https://pokemmo-server.onrender.com/colyseus | Monitor rooms |
| WebSocket | wss://pokemmo-server.onrender.com | Real-time connection |

## 🔧 Configuration

### Environment Variables (Server)

In Render dashboard for `pokemmo-server`, set:

| Variable | Value | Required |
|----------|-------|----------|
| `TREASURY_PRIVATE_KEY` | Your Solana wallet private key | Optional |
| `JWT_SECRET` | Auto-generated by Render | Yes |
| `SOLANA_NETWORK` | `devnet` | Yes |

### Free Tier Limitations

- Server spins down after 15 minutes of inactivity
- First request after spin-down takes ~30 seconds
- 750 hours/month (enough for 1 server + 1 static site)

### Keep Server Awake (Optional)

Use a service like UptimeRobot to ping your server every 10 minutes:
1. Sign up at https://uptimerobot.com (free)
2. Add monitor for: https://pokemmo-server.onrender.com
3. Set interval: 10 minutes

## 🚨 Troubleshooting

### "Cannot connect to server"
- Wait for server to wake up (30 seconds on free tier)
- Check server logs in Render dashboard
- Verify WebSocket URL in client

### "Build failed"
- Check build logs in Render dashboard
- Ensure all dependencies are in package.json
- Verify Node version compatibility

### "Wallet won't connect"
- Install Phantom wallet
- Switch to Devnet network
- Refresh the page

## 📊 Monitor Your Services

In Render Dashboard, you can:
- View logs for each service
- Check CPU/Memory usage
- See deployment history
- Configure custom domains

## 🎯 Testing Your Deployment

1. **Test Server**:
```bash
curl https://pokemmo-server.onrender.com
```

2. **Test WebSocket**:
```javascript
const ws = new WebSocket('wss://pokemmo-server.onrender.com');
ws.onopen = () => console.log('Connected!');
```

3. **Test Game**:
- Open https://pokemmo-client.onrender.com
- Should see the game UI
- Connect wallet
- Join game

## 💡 Pro Tips

1. **Use Blueprint**: Deploys both services with one click
2. **Custom Domain**: Add your own domain in Settings
3. **Auto-Deploy**: Enable auto-deploy from GitHub
4. **Monitoring**: Use Render's metrics to track usage

## 🎮 Play Your Game!

Your PokeMMO game is now FULLY deployed on Render:
- Frontend: https://pokemmo-client.onrender.com
- Backend: https://pokemmo-server.onrender.com

Share the client URL with friends and start playing! 🚀

## 📝 Summary

You now have:
- ✅ Server running on Render (with Solana integration)
- ✅ Client running on Render (with Phantom wallet)
- ✅ WebSocket connection working
- ✅ Free hosting for both services
- ✅ Auto-deploy from GitHub

Everything is on Render's free tier and ready to scale when needed!